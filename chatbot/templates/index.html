<!DOCTYPE html>
<html lang="en">

<head>
    <title>Chatbot</title>
    <link rel="icon" href="/{{src}}/img/chat.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <meta content="utf-8" http-equiv="encoding" />

    <!-- Import Font Awesome -->
    <link rel="stylesheet" type="text/css" href="/{{src}}/css/all.css"/>

    <!-- Import materialize.css -->
    <link rel="stylesheet" type="text/css" href="/{{src}}/css/materialize.min.css"/>

    <link rel="stylesheet" type="text/css" href="/{{src}}/css/style.css"/>
</head>

<body>
    <script>
        var srcName = "{{src}}";
        var userName = "inikki";
    </script>

    <script type="text/javascript" src="/{{src}}/js/jquery.min.js"></script>
    <script type="text/javascript" src="/{{src}}/js/jquery-ui.js"></script>
    <script type="text/javascript" src="/{{src}}/js/lib/materialize.min.js"></script>
    <script type="text/javascript" src="/{{src}}/js/lib/showdown.min.js"></script>
    <script type="text/javascript" src="/{{src}}/js/index.js"></script>

    <script type="text/javascript">
        let ws;
        document.addEventListener("DOMContentLoader", function() {
            var client_id = "{soeid}"
            var ws_url = "{{ws_host}}".replaceAll("&#34;", "");
            var url = `${ws_url}/communicate?client_id=${client_id}`
            if (!ws || ws.readyState === WebSocket.CLOSED) {
                ws = new WebSocket(url);
                ws.onopen = function() {
                    console.log("Web socket connect established.");
                }
                ws.onclose = function() {
                    console.log("Web socket connect closed.");
                }
                ws.onerror = function() {
                    console.log("Web socket connection error.", error)
                }
            }
        })
    </script>

    <div class="container">
        <div class="widget">
            <div class="chatbox-header">
                <span class="chatbox-header-title">My Virtual Assistant</span>
                <div class="chatbox-controls">
                    <button class="reload-btn disabled" title="Reconnect"><i></i></button>
                    <button class="minimize-btn" title="Minimize"><i></i></button>
                    <button class="expand-btn" title="Expand"><i></i></button>
                    <button class="close-btn" title="Close"><i></i></button>
                </div>
            </div>
            <div class="chatbot-header-logo">
                <a href="#">
                    <img src="/{{src}}/img/chatbot-logo.png" height="200" title="Kafka" alt="Kafka">
                </a>
                <span class="salutation" id="salutation"></span>
            </div>

            <!-- chatbot content goes here -->
            <div class="chats" id="chats">
                <div class="clearfix"></div>
            </div>

            <!-- keypad for users to enter messages -->
            <div class="keypad">
                <textarea class="userInput" id="userInput" placeholder="Type a message..." ></textarea>
            </div>

            <div class="quick-links">
                <a href="javascript:;"
                    class="model-feedback-open feedback-img" title="Feedback" ></a>
                <a href="mailto:nikita.lipatov@gmail.com"
                    class="email-img" target="_blank" title="Support" ></a>

                <button class="scroll-to-top" id="scroll-to-top" title="Scroll to top">
                    <i class="fas fa-arrow-up"></i>
                </button>
            </div>
        </div>

        <div class="chat-button">
            <div class="message">
                <span class="tooltiptext">My Virtual Assistant</span>
            </div>
        </div>
    </div>
</body>

</html>